sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel"],function(e,t,o){"use strict";return e.extend("project1.controller.View1",{onInit:function(){const e=new sap.ui.model.json.JSONModel([]);this.getView().setModel(e,"attachmentModel");this._fetchVendors();setInterval(()=>{this._fetchVendors()},1e4)},_fetchVendors:function(){fetch("/odata/v4/vendor/Vendors").then(e=>e.json()).then(e=>{const t=new sap.ui.model.json.JSONModel(e.value);this.getView().setModel(t,"VendModel")}).catch(e=>{console.error("Failed to fetch vendor PDFs:",e)})},onVendorSelect:function(e){const t=e.getParameter("listItem").getBindingContext("VendModel").getProperty("ID");const o=sap.ui.core.UIComponent.getRouterFor(this);o.navTo("View2",{vendor_Id:t})},onFileChange:function(e){const t=e.getParameter("files");this.selectedFiles=t;console.log(this.selectedFiles)},onSubmit:async function(){const e=this.byId("idInput").getValue();const o=this.byId("nameInput").getValue();const n=this.byId("emailInput").getValue();const s=this.byId("phoneInput").getValue();if(!o||!n||!s||!e||!this.selectedFiles||this.selectedFiles.length===0){t.show("Please fill in all vendor details and upload at least one file.");return}try{const i={ID:e,name:o,email:n,phone:s};const l=await fetch("/odata/v2/vendor/VendorCreation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok){const e=await l.text();throw new Error("Vendor creation failed: "+e)}const a=e;for(let e=0;e<this.selectedFiles.length;e++){const t=this.selectedFiles[e];const o=new FormData;o.append("file",t);o.append("vendorID",a);const n=await fetch("/uploadPDF",{method:"POST",body:o});if(!n.ok){throw new Error(`Failed to upload file: ${t.name}`)}}t.show("Vendor and file uploaded successfully.");this.onInit();this.byId("idInput").setValue("");this.byId("nameInput").setValue("");this.byId("emailInput").setValue("");this.byId("phoneInput").setValue("");this.byId("fileUploader").clear();this.selectedFiles=null}catch(e){console.error("Error:",e);t.show("Error occurred during vendor or file upload.")}},onFilter:function(){const e=this.byId("vendorTable");const t=e.getBinding("items");const o=this.byId("vendorIdFilter").getValue();const n=this.byId("vendorNameFilter").getValue();const s=this.byId("statusFilter").getValue();const i=[];if(o){i.push(new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.Contains,o))}if(n){i.push(new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,n))}if(s){i.push(new sap.ui.model.Filter("status",sap.ui.model.FilterOperator.Contains,s))}t.filter(i)}})});
//# sourceMappingURL=View1.controller.js.map